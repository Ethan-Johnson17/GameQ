var R=Object.defineProperty,T=Object.defineProperties;var L=Object.getOwnPropertyDescriptors;var Q=Object.getOwnPropertySymbols;var E=Object.prototype.hasOwnProperty,F=Object.prototype.propertyIsEnumerable;var j=(r,s,l)=>s in r?R(r,s,{enumerable:!0,configurable:!0,writable:!0,value:l}):r[s]=l,D=(r,s)=>{for(var l in s||(s={}))E.call(s,l)&&j(r,l,s[l]);if(Q)for(var l of Q(s))F.call(s,l)&&j(r,l,s[l]);return r},A=(r,s)=>T(r,L(s));import{_ as z,P as J,A as d,g as G,l as g,a as _,p as C,b as k,c as U,s as P}from"./index.f703cb40.js";import{g as M,l as W,u as H,w as K,c as v,a as I,o as n,b as c,d as e,t as m,m as u,h as V,F as f,k as w,i as X,v as Y,p as Z,j as q,G as $,e as S,B,n as O}from"./vendor.b0e93d7b.js";const ee={components:{PlayerItems:J},setup(){const r=M(""),s=W(),l=H(),t=M("Choose a game!");return K(async()=>{try{if(s.params.id&&(await k.findGameNightId(s.params.id),await G.getAllGameQueue(s.params.id),await U.getMyGames("/account/myGames"),await k.getAllPlayers(s.params.id),P.joinRoom(s.params.id)),d.activeGameNight.accountId===d.account.id){await k.getMyGameNights("/account/gamenight");const i=d.myGameNights.find(y=>y.id===s.params.id);d.activeGameNight=i,P.joinRoom(s.params.id)}}catch(o){g.error(o),_.toast("error","error")}}),{editable:r,route:s,newGame:t,player:v(()=>d.players.find(o=>o.accountId===d.account.id)),players:v(()=>d.players),activeGameNight:v(()=>d.activeGameNight),closetGames:v(()=>d.myGames.filter(o=>o.owned)),account:v(()=>d.account),gameQueue:v(()=>d.gameQueue),sortedGameQueue:v(()=>[...d.gameQueue].sort((o,i)=>i.votes.length-o.votes.length)),arrOfNames:v(()=>d.gameQueue.map(o=>o.game.name)),formatDate(o){return new Date(o).toLocaleString()},async addGame(o){try{const i=t.value,y=d.myGames.find(x=>x.name===i);if(t.value==="Choose a game!")return;let N={gameId:y.id,gameNightId:d.activeGameNight.id};await G.addToGameQueue(N),t.value="Choose a game!"}catch(i){g.error(i),_.toast("Someone is bringing that game.","warning")}},async removeGameQueue(o){try{if(!await _.confirm("Delete your game?"))return;await G.removeGameQueue(o)}catch(i){g.error(i),_.toast(i.message,"error")}},async joinGameNight(o){try{await C.attendGameNight(o)}catch(i){g.error(i),_.toast("Something went wrong joining the game!","error")}},async vote(o){try{await G.vote(o)}catch(i){g.error(i)}},async editMyItems(){try{const o=d.players.find(y=>y.account.id===d.account.id);let i=A(D({},o),{items:r.value});await C.editMyItems(i),r.value=""}catch(o){g.error(o),_.toast(o)}},async unattendGameNight(o){try{await _.confirm("Are you sure you want to leave this game night??")&&(await C.unattendGameNight(o),await k.getAllPlayers(s.params.id),l.push({name:"GameNight"}))}catch(i){g.error(i),_.toast(i)}}}}},h=r=>(Z("data-v-09f92a53"),r=r(),q(),r),te={class:"container-fluid"},ae={class:"row justify-content-center p-2"},se={class:"col-md-10 card my-2 elevation-3 px-5 py-3"},oe={class:"row justify-content-center"},ie={class:"col-3"},ne={class:"m-3"},ce={class:"col-md-6 text-dark text-center p-3"},re={class:"col-md-3 text-end p-1"},de={class:"row"},le={class:"col text-dark text-center"},me={key:0,class:"text-dark bg-warning"},ue={class:"row"},he={class:"col"},_e={key:0,class:"row mb-2"},ve={class:"col-md-4"},ye={class:"dropdown input-group"},ge={class:"btn btn-secondary dropdown-toggle form-control",type:"button",id:"dropdownMenuButton1","data-bs-toggle":"dropdown","aria-expanded":"false",style:{"background-color":"#814cb6"}},pe={class:"dropdown-menu","aria-labelledby":"dropdownMenuButton1"},be=["onClick"],fe=h(()=>e("button",{class:"btn bg-white border border-secondary text-secondary px-2",type:"submit"},[e("i",{class:"mdi mdi-plus-thick"})],-1)),we={class:"row"},Ge={class:"col-md-6"},ke=h(()=>e("h3",null,"Vote on the Game(s) to play!",-1)),Ne={class:"col"},xe={class:"vote d-flex"},Ce={key:0},Ie=["onClick"],Se=["onClick"],Qe=["data-bs-target"],je=["onClick"],De={class:"col-md-6"},Ae={class:"row justify-content-end"},Pe={class:"col-md-10 bg-primary mb-3 pb-2 mx-2"},Me=h(()=>e("div",{class:"row"},[e("div",{class:"col text-center mt-3"},[e("h3",null,[e("b",null,"Total Votes")]),e("hr")])],-1)),Ve={key:0,class:"col-9 my-2 mdi"},Be=h(()=>e("i",{class:"mdi mdi-chess-king ms-1"},null,-1)),Oe=h(()=>e("hr",null,null,-1)),Re={key:1,class:"col-9 my-2 mdi"},Te={class:"col-3 my-2"},Le=h(()=>e("hr",null,null,-1)),Ee={class:"row"},Fe={class:"col-6"},ze=h(()=>e("h3",{class:"mb-5"},"What everyone's bringing...",-1)),Je={key:0,class:"input-group"},Ue=h(()=>e("button",{class:"btn btn-secondary",type:"submit"},[e("i",{class:"mdi mdi-plus-thick"})],-1)),We={class:"col my-2"},He={class:"col-6 text-center"},Ke=h(()=>e("h3",{class:"mb-5"},"Attending",-1)),Xe={class:"col d-flex"},Ye=["src"],Ze={class:"mt-3"},qe={class:"fnt ms-3 py-1 mt-2 text-grey"};function $e(r,s,l,t,o,i){const y=I("GameDetails"),N=I("OffCanvas"),x=I("PlayerItems");return n(),c("div",te,[e("div",ae,[e("div",se,[e("div",oe,[e("div",ie,[e("h5",ne,"PIN: "+m(t.activeGameNight.pin),1)]),e("div",ce,[e("h3",null,m(t.activeGameNight.name),1)]),e("div",re,[t.player?u("",!0):(n(),c("button",{key:0,class:"btn btn-secondary px-4",onClick:s[0]||(s[0]=a=>t.joinGameNight(t.activeGameNight.pin))}," Join ")),t.player?(n(),c("button",{key:1,class:"btn btn-danger px-4",onClick:s[1]||(s[1]=a=>t.unattendGameNight(t.player.id))}," Leave ")):u("",!0)])]),e("div",de,[e("div",le,[e("h3",null,m(t.formatDate(t.activeGameNight.gameNightDate)),1),e("h3",null,m(t.activeGameNight.location),1),t.activeGameNight.isCancelled?(n(),c("h3",me," Cancelled ")):u("",!0)])]),e("div",ue,[e("div",he,[t.player?(n(),c("div",_e,[e("div",ve,[e("form",{onSubmit:s[2]||(s[2]=V((...a)=>t.addGame&&t.addGame(...a),["prevent"]))},[e("div",ye,[e("button",ge,m(t.newGame),1),e("ul",pe,[(n(!0),c(f,null,w(t.closetGames,a=>(n(),c("li",{key:a.atlasGameId},[e("div",{class:$(["dropdown-item selectable",t.arrOfNames.includes(a.name)?"disabled":""]),onClick:p=>t.newGame=a.name},m(a.name),11,be)]))),128))]),fe])],32)])])):u("",!0)])]),e("div",we,[e("div",Ge,[ke,(n(!0),c(f,null,w(t.gameQueue,a=>{var p;return n(),c("div",{class:"row",key:a.id},[e("div",Ne,[e("div",xe,[t.player?(n(),c("div",Ce,[a.votes.includes(t.account.id)?u("",!0):(n(),c("i",{key:0,class:"mdi mdi-thumb-up-outline text-secondary f-16 pt-0 selectable h-25 me-2",onClick:b=>t.vote(a.id)},null,8,Ie)),a.votes.includes(t.account.id)?(n(),c("i",{key:1,class:"mdi mdi-thumb-up text-secondary f-16 pt-0 selectable h-25 me-2",onClick:b=>t.vote(a.id)},null,8,Se)):u("",!0)])):u("",!0),e("p",{class:"mb-0 selectable","data-bs-toggle":"offcanvas","data-bs-target":"#gameDetails-"+a.game.id},m((p=a.game)==null?void 0:p.name),9,Qe),t.account.id===a.accountId?(n(),c("i",{key:1,class:"mdi mdi-trash-can f-20 text-danger ms-auto selectable",onClick:b=>t.removeGameQueue(a.id)},null,8,je)):u("",!0)])]),S(N,{id:"gameDetails-"+a.game.id},{"offcanvas-title":B(()=>[O(m(a.game.name)+" Details",1)]),"offcanvas-body":B(()=>[S(y,{game:a.game},null,8,["game"])]),_:2},1032,["id"])])}),128))]),e("div",De,[e("div",Ae,[e("div",Pe,[Me,(n(!0),c(f,null,w(t.sortedGameQueue,a=>{var p,b;return n(),c("div",{class:"row",key:a.id},[a==t.sortedGameQueue[0]?(n(),c("div",Ve,[O(m((p=a.game)==null?void 0:p.name)+" ",1),Be,Oe])):(n(),c("div",Re,m((b=a.game)==null?void 0:b.name),1)),e("div",Te,m(a.votes.length),1)])}),128))])])]),Le]),e("div",Ee,[e("div",Fe,[ze,e("form",{onSubmit:s[4]||(s[4]=V(a=>t.editMyItems(),["prevent"]))},[t.player?(n(),c("div",Je,[X(e("input",{required:"",type:"text",class:"form-control",id:"items",placeholder:"Add items here...","onUpdate:modelValue":s[3]||(s[3]=a=>t.editable=a),maxlength:"1000"},null,512),[[Y,t.editable]]),Ue])):u("",!0)],32),(n(!0),c(f,null,w(t.players,a=>(n(),c("div",{class:"row",key:a.id},[e("div",We,[S(x,{player:a},null,8,["player"])])]))),128))]),e("div",He,[Ke,(n(!0),c(f,null,w(t.players,a=>(n(),c("div",{class:"row",key:a.id},[e("div",Xe,[e("img",{class:"pic me-3 my-1",src:a.account.picture,alt:""},null,8,Ye),e("h5",Ze,m(a.account.name),1),e("p",qe,m(a.account.rank),1)])]))),128))])])])])])}var st=z(ee,[["render",$e],["__scopeId","data-v-09f92a53"]]);export{st as default};
